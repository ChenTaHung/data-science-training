<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Open Data Science</title>
  <meta name="description" content="This is official data science training for the Ocean Health Index, as described in Lowndes et al. 2017.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Open Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is official data science training for the Ocean Health Index, as described in Lowndes et al. 2017." />
  <meta name="github-repo" content="ohi-science/data-science-training" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Open Data Science" />
  
  <meta name="twitter:description" content="This is official data science training for the Ocean Health Index, as described in Lowndes et al. 2017." />
  

<meta name="author" content="Julie Lowndes &amp; The OHI Team">


<meta name="date" content="2017-11-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="viz.html">
<link rel="next" href="tidyr.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#what-to-expect"><i class="fa fa-check"></i><b>2.1</b> What to expect</a><ul>
<li class="chapter" data-level="2.1.1" data-path="overview.html"><a href="overview.html#tidy-data-workflow"><i class="fa fa-check"></i><b>2.1.1</b> Tidy data workflow</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#gapminder-data"><i class="fa fa-check"></i><b>2.2</b> Gapminder data:</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#by-the-end-of-the-course"><i class="fa fa-check"></i><b>2.3</b> By the end of the course…</a></li>
<li class="chapter" data-level="2.4" data-path="overview.html"><a href="overview.html#prerequisites"><i class="fa fa-check"></i><b>2.4</b> Prerequisites</a></li>
<li class="chapter" data-level="2.5" data-path="overview.html"><a href="overview.html#credit"><i class="fa fa-check"></i><b>2.5</b> Credit</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="orientation.html"><a href="orientation.html"><i class="fa fa-check"></i><b>3</b> R/RStudio Orientation, GitHub Setup</a><ul>
<li class="chapter" data-level="3.1" data-path="orientation.html"><a href="orientation.html#objectives-resources"><i class="fa fa-check"></i><b>3.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="3.2" data-path="orientation.html"><a href="orientation.html#why-learn-r-with-rstudio"><i class="fa fa-check"></i><b>3.2</b> Why learn R with RStudio</a></li>
<li class="chapter" data-level="3.3" data-path="orientation.html"><a href="orientation.html#r-at-the-console-rstudio-goodies"><i class="fa fa-check"></i><b>3.3</b> R at the console, RStudio goodies</a><ul>
<li class="chapter" data-level="3.3.1" data-path="orientation.html"><a href="orientation.html#error-messages-are-your-friends"><i class="fa fa-check"></i><b>3.3.1</b> Error messages are your friends</a></li>
<li class="chapter" data-level="3.3.2" data-path="orientation.html"><a href="orientation.html#logical-operators-and-expressions"><i class="fa fa-check"></i><b>3.3.2</b> Logical operators and expressions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="orientation.html"><a href="orientation.html#r-functions-help-pages"><i class="fa fa-check"></i><b>3.4</b> R functions, help pages</a><ul>
<li class="chapter" data-level="3.4.1" data-path="orientation.html"><a href="orientation.html#your-turn"><i class="fa fa-check"></i><b>3.4.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="orientation.html"><a href="orientation.html#clearing-the-environment"><i class="fa fa-check"></i><b>3.5</b> Clearing the environment</a><ul>
<li class="chapter" data-level="3.5.1" data-path="orientation.html"><a href="orientation.html#your-turn-1"><i class="fa fa-check"></i><b>3.5.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="orientation.html"><a href="orientation.html#setup-git-github"><i class="fa fa-check"></i><b>3.6</b> Setup Git &amp; GitHub</a></li>
<li class="chapter" data-level="3.7" data-path="orientation.html"><a href="orientation.html#troubleshooting"><i class="fa fa-check"></i><b>3.7</b> Troubleshooting</a><ul>
<li class="chapter" data-level="3.7.1" data-path="orientation.html"><a href="orientation.html#i-just-entered-a-command-and-nothings-happening"><i class="fa fa-check"></i><b>3.7.1</b> I just entered a command and nothing’s happening</a></li>
<li class="chapter" data-level="3.7.2" data-path="orientation.html"><a href="orientation.html#how-do-i-update-rstudio"><i class="fa fa-check"></i><b>3.7.2</b> How do I update RStudio?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rstudio-github.html"><a href="rstudio-github.html"><i class="fa fa-check"></i><b>4</b> Using RStudio+GitHub, and R Scripts</a><ul>
<li class="chapter" data-level="4.1" data-path="rstudio-github.html"><a href="rstudio-github.html#objectives-resources-1"><i class="fa fa-check"></i><b>4.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="4.2" data-path="rstudio-github.html"><a href="rstudio-github.html#why-should-scientists-use-github"><i class="fa fa-check"></i><b>4.2</b> Why should scientists use Github?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="rstudio-github.html"><a href="rstudio-github.html#what-are-git-and-github"><i class="fa fa-check"></i><b>4.2.1</b> What are Git and Github?</a></li>
<li class="chapter" data-level="4.2.2" data-path="rstudio-github.html"><a href="rstudio-github.html#some-github-terminology"><i class="fa fa-check"></i><b>4.2.2</b> Some Github terminology</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rstudio-github.html"><a href="rstudio-github.html#create-a-repository-on-github.com"><i class="fa fa-check"></i><b>4.3</b> Create a repository on Github.com</a></li>
<li class="chapter" data-level="4.4" data-path="rstudio-github.html"><a href="rstudio-github.html#clone-your-repository-using-rstudio"><i class="fa fa-check"></i><b>4.4</b> Clone your repository using RStudio</a></li>
<li class="chapter" data-level="4.5" data-path="rstudio-github.html"><a href="rstudio-github.html#inspect-your-repository"><i class="fa fa-check"></i><b>4.5</b> Inspect your repository</a></li>
<li class="chapter" data-level="4.6" data-path="rstudio-github.html"><a href="rstudio-github.html#add-files-to-our-local-repo"><i class="fa fa-check"></i><b>4.6</b> Add files to our local repo</a><ul>
<li class="chapter" data-level="4.6.1" data-path="rstudio-github.html"><a href="rstudio-github.html#inspect-what-has-changed"><i class="fa fa-check"></i><b>4.6.1</b> Inspect what has changed</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="rstudio-github.html"><a href="rstudio-github.html#sync-from-rstudio-to-github"><i class="fa fa-check"></i><b>4.7</b> Sync from RStudio to GitHub</a><ul>
<li class="chapter" data-level="4.7.1" data-path="rstudio-github.html"><a href="rstudio-github.html#pull"><i class="fa fa-check"></i><b>4.7.1</b> Pull</a></li>
<li class="chapter" data-level="4.7.2" data-path="rstudio-github.html"><a href="rstudio-github.html#stage"><i class="fa fa-check"></i><b>4.7.2</b> Stage</a></li>
<li class="chapter" data-level="4.7.3" data-path="rstudio-github.html"><a href="rstudio-github.html#commit"><i class="fa fa-check"></i><b>4.7.3</b> Commit</a></li>
<li class="chapter" data-level="4.7.4" data-path="rstudio-github.html"><a href="rstudio-github.html#push"><i class="fa fa-check"></i><b>4.7.4</b> Push</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="rstudio-github.html"><a href="rstudio-github.html#explore-remote-github"><i class="fa fa-check"></i><b>4.8</b> Explore remote Github</a><ul>
<li class="chapter" data-level="4.8.1" data-path="rstudio-github.html"><a href="rstudio-github.html#your-turn-2"><i class="fa fa-check"></i><b>4.8.1</b> Your turn!</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="rstudio-github.html"><a href="rstudio-github.html#create-an-r-script"><i class="fa fa-check"></i><b>4.9</b> Create an R script</a><ul>
<li class="chapter" data-level="4.9.1" data-path="rstudio-github.html"><a href="rstudio-github.html#your-turn-3"><i class="fa fa-check"></i><b>4.9.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="rstudio-github.html"><a href="rstudio-github.html#committing---how-often-tracking-changes-in-your-files"><i class="fa fa-check"></i><b>4.10</b> Committing - how often? Tracking changes in your files</a></li>
<li class="chapter" data-level="4.11" data-path="rstudio-github.html"><a href="rstudio-github.html#troubleshooting-1"><i class="fa fa-check"></i><b>4.11</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>5</b> Visualizing data</a><ul>
<li class="chapter" data-level="5.1" data-path="viz.html"><a href="viz.html#objectives-resources-2"><i class="fa fa-check"></i><b>5.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="5.2" data-path="viz.html"><a href="viz.html#install-our-first-package-tidyverse"><i class="fa fa-check"></i><b>5.2</b> Install our first package: <code>tidyverse</code></a></li>
<li class="chapter" data-level="5.3" data-path="viz.html"><a href="viz.html#aesthetic-mappings"><i class="fa fa-check"></i><b>5.3</b> Aesthetic mappings</a></li>
<li class="chapter" data-level="5.4" data-path="viz.html"><a href="viz.html#push-to-github"><i class="fa fa-check"></i><b>5.4</b> push to GitHub</a><ul>
<li class="chapter" data-level="5.4.1" data-path="viz.html"><a href="viz.html#your-turn-4"><i class="fa fa-check"></i><b>5.4.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="viz.html"><a href="viz.html#common-problems"><i class="fa fa-check"></i><b>5.5</b> Common problems</a><ul>
<li class="chapter" data-level="5.5.1" data-path="viz.html"><a href="viz.html#your-turn-5"><i class="fa fa-check"></i><b>5.5.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="viz.html"><a href="viz.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>5.6</b> The Layered Grammar of Graphics</a></li>
<li class="chapter" data-level="5.7" data-path="viz.html"><a href="viz.html#push-to-github-1"><i class="fa fa-check"></i><b>5.7</b> push to GitHub</a></li>
<li class="chapter" data-level="5.8" data-path="viz.html"><a href="viz.html#end-of-the-day-intro-to-markdown-readme"><i class="fa fa-check"></i><b>5.8</b> end of the day: intro to Markdown (README)?</a></li>
<li class="chapter" data-level="5.9" data-path="viz.html"><a href="viz.html#troubleshooting-2"><i class="fa fa-check"></i><b>5.9</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Data wrangling with dplyr (tidyverse)</a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#objectives-resources-3"><i class="fa fa-check"></i><b>6.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#tidy-data"><i class="fa fa-check"></i><b>6.2</b> Tidy Data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="dplyr.html"><a href="dplyr.html#setup"><i class="fa fa-check"></i><b>6.2.1</b> setup</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#explore-the-gapminder-data.frame"><i class="fa fa-check"></i><b>6.3</b> Explore the gapminder data.frame</a><ul>
<li class="chapter" data-level="6.3.1" data-path="dplyr.html"><a href="dplyr.html#read-data-with-readrread_csv"><i class="fa fa-check"></i><b>6.3.1</b> read data with <code>readr::read_csv()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="dplyr.html"><a href="dplyr.html#look-at-the-variables-inside-a-data.frame"><i class="fa fa-check"></i><b>6.3.2</b> Look at the variables inside a data.frame</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#dplyr-overview"><i class="fa fa-check"></i><b>6.4</b> <code>dplyr</code> overview</a><ul>
<li class="chapter" data-level="6.4.1" data-path="dplyr.html"><a href="dplyr.html#install-tidyverse-which-has-dplyr-inside"><i class="fa fa-check"></i><b>6.4.1</b> install <code>tidyverse</code> (which has <code>dplyr</code> inside)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#use-dplyrfilter-to-subset-data-row-wise-observations."><i class="fa fa-check"></i><b>6.5</b> Use <code>dplyr::filter()</code> to subset data row-wise (observations).</a><ul>
<li class="chapter" data-level="6.5.1" data-path="dplyr.html"><a href="dplyr.html#your-turn-6"><i class="fa fa-check"></i><b>6.5.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#meet-the-new-pipe-operator"><i class="fa fa-check"></i><b>6.6</b> Meet the new pipe operator</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#use-dplyrselect-to-subset-data-column-wise-variables"><i class="fa fa-check"></i><b>6.7</b> Use <code>dplyr::select()</code> to subset data column-wise (variables)</a><ul>
<li class="chapter" data-level="6.7.1" data-path="dplyr.html"><a href="dplyr.html#revel-in-the-convenience"><i class="fa fa-check"></i><b>6.7.1</b> Revel in the convenience</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="dplyr.html"><a href="dplyr.html#use-dplyrmutate-to-add-new-variables"><i class="fa fa-check"></i><b>6.8</b> Use <code>dplyr::mutate()</code> to add new variables</a><ul>
<li class="chapter" data-level="6.8.1" data-path="dplyr.html"><a href="dplyr.html#your-turn-7"><i class="fa fa-check"></i><b>6.8.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="dplyr.html"><a href="dplyr.html#dplyrgroup_by-to-operate-on-groups"><i class="fa fa-check"></i><b>6.9</b> <code>dplyr::group_by()</code> to operate on groups</a><ul>
<li class="chapter" data-level="6.9.1" data-path="dplyr.html"><a href="dplyr.html#dplyrsummarize-with-group_by"><i class="fa fa-check"></i><b>6.9.1</b> <code>dplyr::summarize()</code> with <code>group_by()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="dplyr.html"><a href="dplyr.html#dplyrarrange-to-order"><i class="fa fa-check"></i><b>6.10</b> <code>dplyr::arrange()</code> to order</a></li>
<li class="chapter" data-level="6.11" data-path="dplyr.html"><a href="dplyr.html#your-turn-8"><i class="fa fa-check"></i><b>6.11</b> Your turn</a></li>
<li class="chapter" data-level="6.12" data-path="dplyr.html"><a href="dplyr.html#all-together-now"><i class="fa fa-check"></i><b>6.12</b> All together now</a><ul>
<li class="chapter" data-level="6.12.1" data-path="dplyr.html"><a href="dplyr.html#compare-to-base-r"><i class="fa fa-check"></i><b>6.12.1</b> Compare to base R</a></li>
<li class="chapter" data-level="6.12.2" data-path="dplyr.html"><a href="dplyr.html#your-turn-9"><i class="fa fa-check"></i><b>6.12.2</b> Your turn</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>7</b> Data wrangling with tidyr (tidyverse)</a><ul>
<li class="chapter" data-level="7.1" data-path="tidyr.html"><a href="tidyr.html#objectives-resources-4"><i class="fa fa-check"></i><b>7.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="7.2" data-path="tidyr.html"><a href="tidyr.html#tidyr-overview"><i class="fa fa-check"></i><b>7.2</b> <code>tidyr</code> overview</a><ul>
<li class="chapter" data-level="7.2.1" data-path="tidyr.html"><a href="tidyr.html#install-tidyr-investigate-gapminder-data"><i class="fa fa-check"></i><b>7.2.1</b> Install <code>tidyr</code>, investigate gapminder data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tidyr.html"><a href="tidyr.html#from-wide-to-long-format-with-gather"><i class="fa fa-check"></i><b>7.3</b> From wide to long format with <code>gather()</code></a></li>
<li class="chapter" data-level="7.4" data-path="tidyr.html"><a href="tidyr.html#from-long-to-intermediate-format-with-spread"><i class="fa fa-check"></i><b>7.4</b> From long to intermediate format with <code>spread()</code></a><ul>
<li class="chapter" data-level="7.4.1" data-path="tidyr.html"><a href="tidyr.html#clean-up-and-save-your-.r-script"><i class="fa fa-check"></i><b>7.4.1</b> clean up and save your .r script</a></li>
<li class="chapter" data-level="7.4.2" data-path="tidyr.html"><a href="tidyr.html#other-tidyr-awesomeness"><i class="fa fa-check"></i><b>7.4.2</b> Other tidyr awesomeness</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="tidyr.html"><a href="tidyr.html#other-links"><i class="fa fa-check"></i><b>7.5</b> Other links</a></li>
<li class="chapter" data-level="7.6" data-path="tidyr.html"><a href="tidyr.html#your-turn-10"><i class="fa fa-check"></i><b>7.6</b> Your turn</a></li>
<li class="chapter" data-level="7.7" data-path="tidyr.html"><a href="tidyr.html#troubleshooting-3"><i class="fa fa-check"></i><b>7.7</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>8</b> Analysis, continued</a><ul>
<li class="chapter" data-level="8.1" data-path="analysis.html"><a href="analysis.html#objectives-and-resources"><i class="fa fa-check"></i><b>8.1</b> Objectives and Resources</a></li>
<li class="chapter" data-level="8.2" data-path="analysis.html"><a href="analysis.html#importing-data"><i class="fa fa-check"></i><b>8.2</b> Importing data</a></li>
<li class="chapter" data-level="8.3" data-path="analysis.html"><a href="analysis.html#repeating-operations-with-for-loops"><i class="fa fa-check"></i><b>8.3</b> Repeating operations with for loops</a></li>
<li class="chapter" data-level="8.4" data-path="analysis.html"><a href="analysis.html#conditional-statements-with-if-and-else"><i class="fa fa-check"></i><b>8.4</b> conditional statements with <code>if</code> and <code>else</code></a><ul>
<li class="chapter" data-level="8.4.1" data-path="analysis.html"><a href="analysis.html#todo-variable-classes"><i class="fa fa-check"></i><b>8.4.1</b> TODO: variable classes?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>9</b> Analysis with RMarkdown</a><ul>
<li class="chapter" data-level="9.1" data-path="rmarkdown.html"><a href="rmarkdown.html#objectives-resources-5"><i class="fa fa-check"></i><b>9.1</b> Objectives &amp; Resources</a></li>
<li class="chapter" data-level="9.2" data-path="rmarkdown.html"><a href="rmarkdown.html#intro-to-markdown"><i class="fa fa-check"></i><b>9.2</b> Intro to Markdown</a><ul>
<li class="chapter" data-level="9.2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#from-github.com"><i class="fa fa-check"></i><b>9.2.1</b> from GitHub.com</a></li>
<li class="chapter" data-level="9.2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#from-rstudio"><i class="fa fa-check"></i><b>9.2.2</b> from RStudio</a></li>
<li class="chapter" data-level="9.2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#your-turn-11"><i class="fa fa-check"></i><b>9.2.3</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-from-rstudio"><i class="fa fa-check"></i><b>9.3</b> RMarkdown from RStudio</a><ul>
<li class="chapter" data-level="9.3.1" data-path="rmarkdown.html"><a href="rmarkdown.html#your-turn-12"><i class="fa fa-check"></i><b>9.3.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="rmarkdown.html"><a href="rmarkdown.html#resources-2"><i class="fa fa-check"></i><b>9.4</b> Resources</a></li>
<li class="chapter" data-level="9.5" data-path="rmarkdown.html"><a href="rmarkdown.html#more-practice-data-wrangling-data-viz"><i class="fa fa-check"></i><b>9.5</b> More practice data wrangling, data viz</a><ul>
<li class="chapter" data-level="9.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#your-turn-13"><i class="fa fa-check"></i><b>9.5.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="rmarkdown.html"><a href="rmarkdown.html#troubleshooting-4"><i class="fa fa-check"></i><b>9.6</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="collaborate.html"><a href="collaborate.html"><i class="fa fa-check"></i><b>10</b> Collaborate with GitHub</a><ul>
<li class="chapter" data-level="10.1" data-path="collaborate.html"><a href="collaborate.html#objectives-and-resources-1"><i class="fa fa-check"></i><b>10.1</b> Objectives and Resources</a></li>
<li class="chapter" data-level="10.2" data-path="collaborate.html"><a href="collaborate.html#pull-request-to-your-friends-repo"><i class="fa fa-check"></i><b>10.2</b> pull request to your friend’s repo</a></li>
<li class="chapter" data-level="10.3" data-path="collaborate.html"><a href="collaborate.html#create-gh-pages-repo-and-give-someone-permission"><i class="fa fa-check"></i><b>10.3</b> create gh-pages repo and give someone permission</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Open Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Data wrangling with dplyr (tidyverse)</h1>
<div id="objectives-resources-3" class="section level2">
<h2><span class="header-section-number">6.1</span> Objectives &amp; Resources</h2>
<p>We are going to introduce you to data wrangling in R first with the tidyverse. The tidyverse is a new suite of packages that match a philosophy of data science developed by Hadley Wickham and the RStudio team. I find it to be a more straight-forward way to learn R. We will also show you by comparison what code will look like in “Base R”, which means, in R without any additional packages (like the “tidyverse” package) installed. I like David Robinson’s blog post on the topic of <a href="http://varianceexplained.org/r/teach-hard-way">teaching the tidyverse first</a>.</p>
<p>For some things, base-R is more straight forward, and we’ll show you that too. Whenever we use a function that is from the tidyverse, we will prefix it so you’ll know for sure.</p>
<p><strong>Objectives</strong></p>
<ul>
<li>learn about tidy data</li>
<li>learn <code>dplyr</code> with <code>gapminder</code> data</li>
<li>practice RStudio-GitHub workflow</li>
</ul>
<p><strong>Resources</strong></p>
<p>Today’s materials are again borrowing from some excellent sources, including:</p>
<ul>
<li>Jenny Bryan’s lectures from STAT545 at UBC: <a href="http://stat545.com/block009_dplyr-intro.html">Introduction to dplyr</a></li>
<li>Hadley Wickham and Garrett Grolemund’s <a href="http://r4ds.had.co.nz/">R for Data Science</a></li>
<li>Software Carpentry’s R for reproducible scientific analysis materials: <a href="http://swcarpentry.github.io/r-novice-gapminder/13-dplyr.html">Dataframe manipulation with dplyr</a></li>
<li>First developed for <a href="http://remi-daigle.github.io/2016-04-15-UCSB/dplyr/">Software Carpentry at UCSB</a></li>
<li><a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">RStudio’s data wrangling cheatsheet</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/data-wrangling-with-r-and-rstudio/">RStudio’s data wrangling webinar</a></li>
</ul>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">6.2</span> Tidy Data</h2>
<p>Hadley Wickham, RStudio’s Chief Scientist, has been building R packages for data wrangling and visualization based on the idea of <strong>tidy data</strong>.</p>
<p>Tidy data has a simple convention: put variables in the columns and observations in the rows.</p>
<p><img src="img/tidy_data.png" /> </br> </br> The <code>mpg</code> dataset we were working with this morning was an example of tidy data. When data are tidy, you are set up to work with it for your analyses, plots, etc. </br> </br> <img src="img/tidy_img_mpg.png" /></p>
<p>Right now we are going to use <code>dplyr</code> to wrangle this tidyish data set (the transform part of the cycle), and then come back to tidying messy data using <code>tidyr</code> once we’ve had some fun wrangling. These are both part of the <code>tidyverse</code> package that we’ve already installed:</p>
<div class="figure">
<img src="img/r4ds_data-science.png" />

</div>
<p>And actually, Hadley Wickham and RStudio have created a ton of packages that help you at every step of the way here. This is from one of Hadley’s recent presentations:</p>
<div class="figure">
<img src="img/tidyverse_wickham_pres.jpg" />

</div>
<div id="setup" class="section level3">
<h3><span class="header-section-number">6.2.1</span> setup</h3>
<p>We’ll do this in an R script.</p>
<p><strong>Here’s what to do:</strong></p>
<ol style="list-style-type: decimal">
<li>Clear your workspace (Session &gt; Restart R)</li>
<li>New File &gt; R Script</li>
<li>Save as <code>gapminder-wrangle.R</code>, and add a comment or two to the top (name of the script, your name)</li>
</ol>
</div>
</div>
<div id="explore-the-gapminder-data.frame" class="section level2">
<h2><span class="header-section-number">6.3</span> Explore the gapminder data.frame</h2>
<p>We will work with some of the data from the <a href="http://www.gapminder.org">Gapminder project</a>.</p>
<p>The data are on GitHub, in our course webite. Navigate there by going to:</p>
<p>github.com &gt; ohi-science &gt; data-science-training &gt; data &gt; gapminder.csv</p>
<p>or by copy-pasting this in the browser: <code>https://github.com/OHI-Science/data-science-training/blob/master/data/gapminder.csv</code></p>
<p>Have a look at the data. It’s a .csv file, which you’ve probably encountered before, but GitHub has formatted it nicely so it’s easy to look at. You can see that for every country and year, there are several columns with data in them.</p>
<div class="figure">
<img src="img/gapminder_gh.png" />

</div>
<div id="read-data-with-readrread_csv" class="section level3">
<h3><span class="header-section-number">6.3.1</span> read data with <code>readr::read_csv()</code></h3>
<p>We can read this data into R directly from GitHub, without downloading it. We can do that by clicking on the Raw button on the top-right of the data. This displays it as the raw csv file, without formatting. Copy the url:</p>
<p><a href="https://raw.githubusercontent.com/jules32/2017-11-30-MBARI/gh-pages/data/gapminder.csv" class="uri">https://raw.githubusercontent.com/jules32/2017-11-30-MBARI/gh-pages/data/gapminder.csv</a></p>
<p>Now, let’s go back to RStudio. In our R script, let’s read this csv file and name the variable “gapminder”. We will use the read_csv function from the readr package (part of the tidyverse, so it’s already installed!). And for comparison, you could also do it in base-R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## read gapminder csv. Note the readr:: prefix identifies which package it&#39;s in
gapminder &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/jules32/2017-11-30-MBARI/gh-pages/data/gapminder.csv&#39;</span>) </code></pre></div>
<p>Let’s inspect:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## explore the gapminder dataset
gapminder <span class="co"># this is super long! Let&#39;s inspect in different ways</span></code></pre></div>
<p>Let’s use <code>head</code> and <code>tail</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(gapminder) <span class="co"># shows first 6</span>
<span class="kw">tail</span>(gapminder) <span class="co"># shows last 6</span>

<span class="kw">head</span>(gapminder, <span class="dv">10</span>) <span class="co"># shows first X that you indicate</span>
<span class="kw">tail</span>(gapminder, <span class="dv">12</span>) <span class="co"># guess what this does!</span></code></pre></div>
<p><code>str()</code> will provide a sensible description of almost anything: when in doubt, just <code>str()</code> some of the recently created objects to get some ideas about what to do next.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(gapminder) <span class="co"># ?str - displays the structure of an object</span></code></pre></div>
<p><code>gapminder</code> is a <code>data.frame</code>. We aren’t going to get into the other types of data receptacles today (‘arrays’, ‘matrices’), because working with data.frames is what you should primarily use. Why?</p>
<ul>
<li>data.frames package related variables neatly together, great for analysis</li>
<li>most functions, including the latest and greatest packages actually <strong>require</strong> that your data be in a data.frame</li>
<li>data.frames can hold variables of different flavors such as
<ul>
<li>character data (country or continent names; “Characters (chr)”)</li>
<li>quantitative data (years, population; “Integers (int)” or “Numeric (num)”)</li>
<li>categorical information (male vs. female)</li>
</ul></li>
</ul>
<p>We can also see the <code>gapminder</code> variable in RStudio’s Environment pane (top right)</p>
<p>More ways to learn basic info on a data.frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(gapminder)
<span class="kw">dim</span>(gapminder)    <span class="co"># ?dim dimension</span>
<span class="kw">ncol</span>(gapminder)   <span class="co"># ?ncol number of columns</span>
<span class="kw">nrow</span>(gapminder)   <span class="co"># ?nrow number of rows</span></code></pre></div>
<p>We can combine using <code>c()</code> to reverse-engineer <code>dim()</code>! Just a side-note here, but I wanted to introduce you to <code>c()</code>: we’ll use it later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">nrow</span>(gapminder), <span class="kw">ncol</span>(gapminder)) <span class="co"># ?c combines values into a vector or list. </span></code></pre></div>
<p>A statistical overview can be obtained with <code>summary()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(gapminder)</code></pre></div>
</div>
<div id="look-at-the-variables-inside-a-data.frame" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Look at the variables inside a data.frame</h3>
<p>To specify a single variable from a data.frame, use the dollar sign <code>$</code>. The <code>$</code> operator is a way to extract of replace parts of an object–check out the help menu for <code>$</code>. It’s a common operator you’ll see in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder<span class="op">$</span>lifeExp <span class="co"># very long! hard to make sense of...</span>
<span class="kw">head</span>(gapminder<span class="op">$</span>lifeExp) <span class="co"># can do the same tests we tried before</span>
<span class="kw">str</span>(gapminder<span class="op">$</span>lifeExp) <span class="co"># it is a single numeric vector</span>
<span class="kw">summary</span>(gapminder<span class="op">$</span>lifeExp) <span class="co"># same information, just formatted slightly differently</span></code></pre></div>
</div>
</div>
<div id="dplyr-overview" class="section level2">
<h2><span class="header-section-number">6.4</span> <code>dplyr</code> overview</h2>
<p>OK, so let’s start wrangling with dplyr.</p>
<p>There are five <code>dplyr</code> functions that you will use to do the vast majority of data manipulations:</p>
<ul>
<li><strong>pick observations by their values (<code>filter()</code>)</strong>,
<ul>
<li><img src="img/rstudio-cheatsheet-filter.png" width="300"/></li>
</ul></li>
<li><strong>pick variables by their names (<code>select()</code>)</strong>,
<ul>
<li><img src="img/rstudio-cheatsheet-select.png" width="300"/></li>
</ul></li>
<li><strong>create new variables with functions of existing variables (<code>mutate()</code>)</strong>,
<ul>
<li><img src="img/rstudio-cheatsheet-mutate.png" width="300"/></li>
</ul></li>
<li><strong>collapse many values down to a single summary (<code>summarise()</code>)</strong>,
<ul>
<li><img src="img/rstudio-cheatsheet-summarise.png" width="300"/></li>
</ul></li>
<li><strong>reorder the rows (<code>arrange()</code>)</strong></li>
</ul>
<p>These can all be used in conjunction with <code>group_by()</code> which changes the scope of each function from operating on the entire dataset to operating on it group-by-group. These six functions provide the verbs for a language of data manipulation.</p>
<p>All verbs work similarly:</p>
<ol style="list-style-type: decimal">
<li>The first argument is a data frame.</li>
<li>The subsequent arguments describe what to do with the data frame. You can refer to columns in the data frame directly without using <code>$</code>.</li>
<li>The result is a new data frame.</li>
</ol>
<p>Together these properties make it easy to chain together multiple simple steps to achieve a complex result.</p>
<div id="install-tidyverse-which-has-dplyr-inside" class="section level3">
<h3><span class="header-section-number">6.4.1</span> install <code>tidyverse</code> (which has <code>dplyr</code> inside)</h3>
<p>In your R script, let’s make sure we’ve got our libraries loaded. Write the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)     ## install.packages(&quot;tidyverse&quot;)</code></pre></div>
<p>This has become a standard practice for how to load a library in a script, and if you get an error that the library doesn’t exist, you can install the package easily by running the code within the comment (highlight <code>install.packages(&quot;tidyverse&quot;)</code> and run it).</p>
</div>
</div>
<div id="use-dplyrfilter-to-subset-data-row-wise-observations." class="section level2">
<h2><span class="header-section-number">6.5</span> Use <code>dplyr::filter()</code> to subset data row-wise (observations).</h2>
<p>You will want to isolate bits of your data; maybe you want to just look at a single country or a few years. R calls this subsetting.</p>
<p><code>filter()</code> is a function in <code>dplyr</code> that takes logical expressions and returns the rows for which all are <code>TRUE</code>.</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="img/rstudio-cheatsheet-filter.png" /> Remember your logical expressions from this morning? We’ll use <code>&lt;</code> and <code>==</code> here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(gapminder, lifeExp <span class="op">&lt;</span><span class="st"> </span><span class="dv">29</span>)</code></pre></div>
<p>You can say this out loud: “Filter the gapminder data for life expectancy less than 29”. Notice that when we do this, all the columns are returned, but just the rows that have the life expectancy less than 29. We’ve subsetted by row.</p>
<p>Let’s try another: “Filter the gapminder data for the country Mexico”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Mexico&quot;</span>)</code></pre></div>
<p>How about if we want two country names? We can’t use the <code>==</code> operator here, because it can only operate on one thing at a time. We will use the <code>%in%</code> operator:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(gapminder, country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Peru&quot;</span>))</code></pre></div>
<p>How about if we want Mexico in 2002? You can pass filter different criteria:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Mexico&quot;</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">2002</span>)</code></pre></div>
<div id="your-turn-6" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Your turn</h3>
<p>What is the mean life expenctancy of Sweden? Hint: do this in 2 steps by assigning a variable and then using the <code>mean()</code> function.</p>
<p>Then, sync to Github.com (pull, stage, commit, push).</p>
<p><em>Answer</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>)  
<span class="kw">mean</span>(x<span class="op">$</span>lifeExp)  </code></pre></div>
<!---Don't use this one for now because gets off track for %>%
2. Choose a country. How much has the population changed since the earliest record? Hint: create variables for the earliest and most recent years, and subtract from each other.  
x1 <- filter(gapminder, country == "Sweden", year == 1952)
x2 <- filter(gapminder, country == "Sweden", year == 2007)
x2$pop - x1$pop
##  1906415
--->
</div>
</div>
<div id="meet-the-new-pipe-operator" class="section level2">
<h2><span class="header-section-number">6.6</span> Meet the new pipe operator</h2>
<p>Before we go any further, we should exploit the new pipe operator that <code>dplyr</code> imports from the <a href="https://github.com/smbache/magrittr"><code>magrittr</code></a> package by Stefan Bache. <strong>This is going to change your data analytical life</strong>. You no longer need to enact multi-operation commands by nesting them inside each other. And we won’t need to make temporary variables like we did in the Sweden example above. This new syntax leads to code that is much easier to write and to read: it actually tells the story of your analysis.</p>
<p>Here’s what it looks like: <code>%&gt;%</code>. The RStudio keyboard shortcut: Ctrl + Shift + M (Windows), Cmd + Shift + M (Mac).</p>
<p>Let’s demo then I’ll explain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<p>This is equivalent to <code>head(gapminder)</code>. This pipe operator takes the thing on the left-hand-side and <strong>pipes</strong> it into the function call on the right-hand-side – literally, drops it in as the first argument.</p>
<p>Never fear, you can still specify other arguments to this function! To see the first 3 rows of Gapminder, we could say <code>head(gapminder, 3)</code> or this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)</code></pre></div>
<p><strong>I’ve advised you to think “gets” whenever you see the assignment operator, <code>&lt;-</code>. Similary, you should think “and then” whenever you see the pipe operator, <code>%&gt;%</code>.</strong></p>
<p>You are probably not impressed yet, but the magic will soon happen.</p>
<p>Fun break: check out <a href="https://twitter.com/backerman150/status/926479565869993984">this gif about %&gt;% from Twitter</a>.</p>
</div>
<div id="use-dplyrselect-to-subset-data-column-wise-variables" class="section level2">
<h2><span class="header-section-number">6.7</span> Use <code>dplyr::select()</code> to subset data column-wise (variables)</h2>
<p>Back to <code>dplyr</code> …</p>
<p>Use <code>select()</code> to subset the data on variables or columns.</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<div class="figure">
<img src="img/rstudio-cheatsheet-select.png" />

</div>
<p>Here’s a conventional call. Again, see that we can select multiple columns just with a comma, after we specify the data frame (gapminder).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(gapminder, year, lifeExp) </code></pre></div>
<p>But using what we just learned, with a pipe, we can do this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, lifeExp)</code></pre></div>
<p>Let’s write it again but using multiple lines so it’s nicer to read. And let’s add a second pipe operator to pipe through <code>head</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, lifeExp) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">4</span>)</code></pre></div>
<p>Think: “Take <code>gapminder</code>, then select the variables year and lifeExp, then show the first 4 rows.”</p>
<p>Being able to read a story out of code like this is really game-changing.</p>
<div id="revel-in-the-convenience" class="section level3">
<h3><span class="header-section-number">6.7.1</span> Revel in the convenience</h3>
<p>Let’s take the gapminder data and filter for the country Cambodia, and select 4 of the columns: country, year, pop, gdpPercap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(country, year, pop, gdpPercap) </code></pre></div>
<p>But entering each column by hand can be tedious, especially since there are fewer columns we <em>don’t</em> want. So instead, we can do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="co"># you can use - to deselect columns</span></code></pre></div>
</div>
</div>
<div id="use-dplyrmutate-to-add-new-variables" class="section level2">
<h2><span class="header-section-number">6.8</span> Use <code>dplyr::mutate()</code> to add new variables</h2>
<p>Alright, let’s keep going.</p>
<p>Let’s say we needed to add an index column so we know which order these data came in. Let’s not make a new variable, let’s add a column to our gapminder data frame. How do we do that? With the <code>mutate()</code> function.</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<div class="figure">
<img src="img/rstudio-cheatsheet-mutate.png" />

</div>
<p>We will name our new column index. We will name the new column ‘index’; and we assign it with a single <code>=</code>. Notice that we can use the <code>nrow</code> function <em>within</em> our mutate call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(gapminder))</code></pre></div>
<p>OK, let’s do another example. Imagine we wanted to recover each country’s GDP. After all, the Gapminder data has a variable for population and GDP per capita.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap)</code></pre></div>
<div id="your-turn-7" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Your turn</h3>
<p>Find the maximum gdpPercap of Egypt and Vietnam Create a new column.</p>
<p>Then, sync to Github.com (pull, stage, commit, push).</p>
<p><em>Answer</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># not super necessary but to simplify</span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Egypt&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp))

## you can also create multiple variables within the same mutate(), and line them up so they are easier to read:
gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># not super necessary but to simplify</span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Vietnam&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp     =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap,
         <span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp))</code></pre></div>
<p>With the things we know so far, the answers you have are maybe a bit limiting. First, We had to act on Egypt and Vietnam separately, and repeat the same code. Copy-pasting like this is also super error prone.</p>
<p>And second, this <code>max_gdpPercap</code> column is pretty redundant, because it’s a repeated value a ton of times. Sometimes this is exactly what you want! You are now set up nicely to maybe take a proportion of gdpPercap/max_gdpPercap for each year or something. But maybe you just wanted that max_gdpPercap for something else. Let’s keep going…</p>
</div>
</div>
<div id="dplyrgroup_by-to-operate-on-groups" class="section level2">
<h2><span class="header-section-number">6.9</span> <code>dplyr::group_by()</code> to operate on groups</h2>
<p>Let’s tackle that first issue first. So how do we less painfully calculate the max gdpPercap for all countries?</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<div class="figure">
<img src="img/rstudio-cheatsheet-group_by.png" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp     =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap,
         <span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="co"># if you use group_by, also use ungroup() to save heartache later</span></code></pre></div>
<p>So instead of filtering for a specific country, we’ve grouped by country, and then done the same operations. It’s hard to see; let’s look at a bunch at the tail:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp     =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap,
         <span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tail</span>(<span class="dv">30</span>)</code></pre></div>
<p>OK, this is great. But what if this what we needed, a max_gdp value for each country. We don’t need that kind of repeated value for each of the max_gdp values. Here’s the next function:</p>
<div id="dplyrsummarize-with-group_by" class="section level3">
<h3><span class="header-section-number">6.9.1</span> <code>dplyr::summarize()</code> with <code>group_by()</code></h3>
<p>We want to operate on a group, but actually collapse or distill the output from that group. The <code>summarize()</code> function will do that for us.</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="img/rstudio-cheatsheet-summarise.png" /> Here we go:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre></div>
<p>How cool is that! <code>summarize()</code> will actually only keep the columns that are grouped_by or summarized. So if we wanted to keep other columns, we’d have to do it another way (we’ll get into it tomorrow).</p>
</div>
</div>
<div id="dplyrarrange-to-order" class="section level2">
<h2><span class="header-section-number">6.10</span> <code>dplyr::arrange()</code> to order</h2>
<p>This is ordered alphabetically, which is cool. But let’s say we wanted to order it in ascending order for <code>max_gdp</code>. The dplyr function is <code>arrange()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(max_gdp)</code></pre></div>
</div>
<div id="your-turn-8" class="section level2">
<h2><span class="header-section-number">6.11</span> Your turn</h2>
<p>Do the following:</p>
<ol style="list-style-type: decimal">
<li>arrange your data frame in descending order (opposite of what we’ve done). Expect that this is possible: use the Help pages.</li>
<li>save your data frame as a variable</li>
<li>Sync your R script to GitHub (pull, stage, commit, push)</li>
</ol>
</div>
<div id="all-together-now" class="section level2">
<h2><span class="header-section-number">6.12</span> All together now</h2>
<p>We have done a pretty incredible amount of work in a few lines. Our whole analysis is this. Imagine the possibilities from here. It’s very readable: you see the data as the first thing, it’s not nested. Then, you can read the verbs. This is the whole thing, with explicit package calls from <code>readr::</code> and <code>dplyr::</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## gapminder-wrangle.R
## J. Lowndes lowndes@nceas.ucsb.edu


## load libraries
<span class="kw">library</span>(tidyverse) ## install.packages(&#39;tidyverse&#39;)

## read in data
gapminder &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/jules32/2017-11-30-MBARI/gh-pages/data/gapminder.csv&#39;</span>) 

## summarize
max_gdp &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># or select(country, year, pop, gdpPercap)</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">max_gdp =</span> <span class="kw">max</span>(gdp)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() </code></pre></div>
<p>I actually am borrowing this “All together now” from Tony Fischetti’s blog post <a href="http://www.statsblogs.com/2014/02/10/how-dplyr-replaced-my-most-common-r-idioms/">How dplyr replaced my most common R idioms</a>). With that as inspiration, this is how what we have just done would look like in Base R.</p>
<div id="compare-to-base-r" class="section level3">
<h3><span class="header-section-number">6.12.1</span> Compare to base R</h3>
<p>Let’s compare with some base R code to accomplish the same things. Base R requires subsetting with the <code>[rows, columns]</code> notatation. This notation is something you’ll see a lot in base R. the brackets <code>[ ]</code> allow you to extract parts of an object. Within the brackets, the comma separates rows from columns.</p>
<p>If we don’t write anything after the comma, that means “all columns”. And if we don’t write anything before the comma, that means “all rows”.</p>
<p>Also, the <code>$</code> operator is how you access specific columns of your dataframe. You can also add new columns like we do with <code>mex$gdp</code>.</p>
<p>Here we will just calculate the max for one country, Mexico. Tomorrow we will learn how to do it for all the countries, like we did with <code>dplyr::group_by()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## gapminder-wrangle.R --- baseR
## J. Lowndes lowndes@nceas.ucsb.edu

## Note the stringAsFactors = FALSE variable to avoid factors!
gapminder &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/jules32/2017-11-30-MBARI/gh-pages/data/gapminder.csv&#39;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) 

## subsetting columns. Compare to `dplyr::select()`
x1  &lt;-<span class="st"> </span>gapminder[ , <span class="kw">c</span>(<span class="st">&#39;country&#39;</span>, <span class="st">&#39;year&#39;</span>, <span class="st">&#39;pop&#39;</span>, <span class="st">&#39;gdpPercap&#39;</span>) ]

## subsetting rows. Compare to `dplyr::filter()`
mex &lt;-<span class="st"> </span>x1[x1<span class="op">$</span>country <span class="op">==</span><span class="st"> &quot;Mexico&quot;</span>, ]

## adding new columns. Compare to `dplyr::mutate()`. 
mex<span class="op">$</span>gdp &lt;-<span class="st"> </span>mex<span class="op">$</span>pop <span class="op">*</span><span class="st"> </span>mex<span class="op">$</span>gdpPercap
mex<span class="op">$</span>max_gdp &lt;-<span class="st"> </span><span class="kw">max</span>(mex<span class="op">$</span>gdp)</code></pre></div>
<p>Note too that the chain operator <code>%&gt;%</code> that we used with the <code>tidyverse</code> lets us get away from the temporary variable x1.</p>
</div>
<div id="your-turn-9" class="section level3">
<h3><span class="header-section-number">6.12.2</span> Your turn</h3>
<p>Get your script cleaned up and sync it for the last time today!</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidyr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
